/* Fondational Elements */
body {
    font-family: 'Merriweather', serif;
    background-color: #fdfdf5; /* Off-white/cream */
    color: #3d3d3d; /* Dark sepia/charcoal */
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    padding-top: env(safe-area-inset-top, 1.25rem);
    padding-bottom: env(safe-area-inset-bottom, 6rem);
    background-image: url('../images/aged-paper-texture.png');
    background-repeat: repeat;
}

h1, h2, h3, h4, h5, h6 {
    font-family: 'Special Elite', monospace;
}

/* Monospaced text for Morse code display */
.morse-code, /* Add this class to elements displaying Morse code */
#tapperMorseOutput,
#morse-output,
#current-decoded-char,
#full-book-morse-display { /* Apply to existing Morse display elements */
    font-family: 'Courier Prime', monospace;
}

.app-container {
    background-color: rgba(253, 253, 245, 0.8); /* Slightly transparent off-white to show texture */
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); /* Softer shadow for vintage feel */
    width: 100%;
}

.main-title {
    color: #3d3d3d; /* Dark sepia/charcoal */
    margin-top: env(safe-area-inset-top, 1rem);
}

.input-output-box {
    background-color: #f0eade; /* Lighter parchment for inputs */
    color: #3d3d3d;
    border: 1px solid #8b7355; /* Aged brass border */
    border-radius: 4px;
    min-height: 100px;
    padding: 10px;
    white-space: pre-wrap;
    word-wrap: break-word;
    font-family: 'Courier Prime', monospace; /* Consistent monospaced for these areas */
}

.section-title {
    color: #3d3d3d; /* Dark sepia/charcoal for section titles */
    margin-top: 20px;
    margin-bottom: 10px;
}

/* Book Cipher Tab background texture */
#book-cipher-tab .app-container {
    background-image: url('../images/dark-leather-texture.png');
    background-color: #4b3832; /* Dark brown fallback if leather texture fails */
    background-size: cover;
    background-position: center;
    color: #f0eade; /* Lighter parchment text color on dark leather */
    border: 2px solid #8b7355; /* Aged brass border for the container itself */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3), inset 0 0 10px rgba(0,0,0,0.5); /* Outer shadow and inner shadow for depth */
}

/* Ensure text and elements within book cipher tab are readable on dark leather */
#book-cipher-tab .app-container h1,
#book-cipher-tab .app-container h2,
#book-cipher-tab .app-container h3,
#book-cipher-tab .app-container h4,
#book-cipher-tab .app-container p,
#book-cipher-tab .app-container label,
#book-cipher-tab .app-container .section-title { /* Ensure section titles also adapt */
    color: #f0eade !important; /* Parchment color for text */
}

#book-cipher-tab .app-container button,
#book-cipher-tab .app-container .button {
    background-color: #a98d6a !important; /* Brass for buttons */
    color: #3d3d3d !important; /* Darker text on brass buttons for contrast */
    border-color: #8b7355 !important;
}
#book-cipher-tab .app-container button:hover,
#book-cipher-tab .app-container .button:hover {
    background-color: #b99d7a !important;
    color: #302010 !important;
}

#book-cipher-tab .app-container .input-output-box,
#book-cipher-tab .app-container #unlocked-text-display, /* Target specific elements */
#book-cipher-tab .app-container #full-book-morse-display,
#book-cipher-tab .app-container #current-decoded-char {
    background-color: rgba(240, 234, 222, 0.15); /* Very transparent parchment on leather */
    color: #fdfdf5 !important; /* Cream text for readability */
    border: 1px solid #a98d6a; /* Brass accent for borders */
}
#book-cipher-tab .app-container #current-decoded-char { /* Specific styling for target char display */
    background-color: rgba(169, 141, 106, 0.5) !important; /* Semi-transparent brass */
    border: 2px solid #8b7355 !important;
}

#book-cipher-tab .app-container ::placeholder {
    color: rgba(240, 234, 222, 0.6) !important;
}
#book-cipher-tab .app-container .book-cover-item {
    background-color: rgba(210, 180, 140, 0.7) !important; /* More transparent tan for book covers on leather */
    color: #3d3d3d !important;
    border-color: rgba(139, 115, 85, 0.8) !important;
}
#book-cipher-tab .app-container .book-cover-selected {
    background-color: rgba(185, 157, 122, 0.85) !important; /* More transparent brass for selected book */
    color: #fdfdf5 !important;
}


/* Core Interactive Elements */
button, .button { /* Apply .button class for non-button elements styled as buttons */
    font-family: 'Special Elite', monospace;
    background-color: #a98d6a; /* Brass accent */
    color: #fdfdf5; /* Off-white/cream text for contrast */
    border: 2px solid #8b7355; /* Darker, aged brass border */
    padding: 10px 15px;
    border-radius: 4px; /* Slightly rounded corners */
    box-shadow: inset 0 0 3px rgba(0,0,0,0.3), 0 2px 3px rgba(0,0,0,0.2); /* Inset shadow for depth, subtle outer shadow */
    text-transform: uppercase; /* Common for vintage plaques */
    letter-spacing: 1px;
    cursor: pointer;
    transition: background-color 0.2s ease-out, box-shadow 0.2s ease-out, transform 0.1s ease-out;
}

button:hover, .button:hover {
    background-color: #b99d7a; /* Slightly lighter brass on hover */
    box-shadow: inset 0 0 4px rgba(0,0,0,0.4), 0 3px 4px rgba(0,0,0,0.3);
}

button:active, .button:active {
    background-color: #8b7355; /* Darker brass when pressed */
    transform: translateY(1px);
    box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
}

/* Styling for Tailwind-based buttons to align with the new theme */
/* This will require careful overriding or replacing Tailwind classes in HTML */
.bg-blue-500, .bg-blue-600, .bg-green-500, .bg-purple-500, .bg-red-500, .bg-red-600, .bg-gray-600, .bg-gray-700 {
    /* Override Tailwind background colors for buttons */
    background-color: #a98d6a !important; /* Important to override Tailwind */
    color: #fdfdf5 !important;
    border: 2px solid #8b7355 !important;
    font-family: 'Special Elite', monospace !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    box-shadow: inset 0 0 3px rgba(0,0,0,0.3), 0 2px 3px rgba(0,0,0,0.2) !important;
}
.hover\:bg-blue-700:hover, .hover\:bg-green-700:hover, .hover\:bg-purple-700:hover, .hover\:bg-red-700:hover, .hover\:bg-gray-700:hover {
    background-color: #b99d7a !important;
    box-shadow: inset 0 0 4px rgba(0,0,0,0.4), 0 3px 4px rgba(0,0,0,0.3) !important;
}
.active\:bg-blue-800:active, .active\:bg-green-800:active, .active\:bg-purple-800:active, .active\:bg-red-800:active, .active\:bg-gray-800:active {
    background-color: #8b7355 !important;
    transform: translateY(1px) !important;
    box-shadow: inset 0 0 5px rgba(0,0,0,0.5) !important;
}
/* Remove Tailwind text colors if they conflict, or ensure they are #fdfdf5 */
.text-white {
    /* color: #fdfdf5 !important; /* Ensure button text is consistently styled */
}

/* General Tailwind text color overrides for the new light theme */
.text-gray-100,
.text-gray-200,
.text-gray-300,
.text-gray-400,
.text-gray-500 { /* Also include slightly darker grays if they were meant for dark text on light bg */
    color: #3d3d3d !important; /* Use theme's primary text color */
}
/* For any text that was explicitly white for dark mode, make it primary text color */
.text-white {
    color: #3d3d3d !important;
}
/* However, buttons and other specific components already override text-white for their specific needs (e.g., cream text on brass button) */
/* So, the .text-white override above should be general. We need to make sure it doesn't break themed components. */
/* Let's refine: buttons already set their text color. This .text-white should apply to general text content. */

/* Re-evaluating .text-white: many buttons use .text-white. My button CSS already sets text to #fdfdf5.
   So, a global .text-white override to #3d3d3d might be too broad.
   Let's remove the global .text-white override and handle specific cases if they arise.
   The main issue is text-gray-XXX classes on a light background.
*/
.text-white {
    /* Keep this commented for now, rely on component-specific text colors.
    /* color: #3d3d3d !important; */
}


/* Navigation Tabs */
nav { /* Assuming nav is the container for tab buttons */
    background-color: transparent !important; /* Overriding Tailwind's bg-gray-800 for the main nav bar */
}

nav button { /* General style for tab buttons */
    font-family: 'Special Elite', monospace;
    background-color: #a98d6a; /* Brass accent */
    color: #fdfdf5;
    border: 2px solid #8b7355; /* Aged brass border */
    box-shadow: inset 0 0 3px rgba(0,0,0,0.3), 0 2px 3px rgba(0,0,0,0.2);
    margin: 0 2px; /* Small margin between tabs */
    padding: 8px 12px; /* Adjust padding as needed */
    border-bottom: none; /* Remove bottom border for a more integrated look with potential underline */
    transition: background-color 0.2s ease-out, box-shadow 0.2s ease-out, border-bottom 0.2s ease-out;
    position: relative; /* For pseudo-element underline */
}

nav button:hover {
    background-color: #b99d7a;
    box-shadow: inset 0 0 4px rgba(0,0,0,0.4), 0 3px 4px rgba(0,0,0,0.3);
}

nav button.active-tab-button {
    background-color: #8b7355; /* Darker, "pressed" brass */
    color: #fdfdf5;
    box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
    /* Engraved line effect */
    border-bottom: 2px solid #6b5335; /* Darker line for engraving effect */
    /* Alternative: pseudo-element for more control over the line */
}

/* Overriding Tailwind for nav buttons specifically if they have those classes */
/* This is similar to the general button overrides but targeted at nav context if needed */
nav .bg-blue-600, nav .bg-gray-700 {
    background-color: #a98d6a !important;
    color: #fdfdf5 !important;
    border: 2px solid #8b7355 !important;
    font-family: 'Special Elite', monospace !important;
    box-shadow: inset 0 0 3px rgba(0,0,0,0.3), 0 2px 3px rgba(0,0,0,0.2) !important;
}
nav .hover\:bg-blue-700:hover, nav .hover\:bg-gray-600:hover {
    background-color: #b99d7a !important;
    box-shadow: inset 0 0 4px rgba(0,0,0,0.4), 0 3px 4px rgba(0,0,0,0.3) !important;
}
nav .active-tab-button.bg-blue-600, nav .active-tab-button.bg-gray-800 /* Tailwind active might be different */ {
    background-color: #8b7355 !important; /* "Pressed" look */
    box-shadow: inset 0 0 5px rgba(0,0,0,0.5) !important;
    border-bottom: 2px solid #6b5335 !important; /* Engraved line */
}
/* Ensure text color on active tab is correct */
nav .active-tab-button, nav .active-tab-button .text-white, nav .active-tab-button .text-gray-300 {
    color: #fdfdf5 !important;
}


/* Original styles below, will be reviewed and updated in subsequent steps */
        .reference-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .reference-table th, .reference-table td {
            border: 1px solid #555;
            padding: 8px;
            text-align: center;
        }
        .reference-table th {
            background-color: #3a3a3a; /* Header background for table */
        }
        .hidden {
            display: none;
        }
        .active-tab-button { /* This class is used in HTML for active tab styling */
            /* font-weight: 600; /* Tailwind semibold */ /* Replaced by new active style */
            /* box-shadow: 0 2px 4px rgba(0,0,0,0.2); */ /* Replaced by new active style */
        }
        .tab-content {
            width: 100%; /* Ensure it spans the full width available */
            /* e.g., padding-top: 1rem; */
        }

        #tab-content-wrapper {
            width: 100%;
        }

        /* Tapper CSS */
        /* Remove or comment out the old .tapper styles */
        /*
        .tapper {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background-color: #4a5568;
            border: 4px solid #2d3748;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: bold;
            color: #e2e8f0;
            cursor: pointer;
            touch-action: manipulation;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            transition: all 0.1s ease-out;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            flex-shrink: 0;
        }
        @media (min-width: 768px) {
            .tapper {
                width: 150px;
                height: 150px;
                font-size: 1.5rem;
            }
        }
        .tapper:active, .tapper.active {
            background-color: #f6e05e;
            color: #1a202c;
            transform: scale(0.95);
            box-shadow: 0 0 20px #f6e05e, 0 0 30px #f6e05e;
        }
        */

        /* New Telegraph Tapper Styles */
        .tapper-assembly {
            position: relative;
            width: 150px; /* Overall width of the tapper assembly */
            height: 100px; /* Overall height */
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation; /* Prevents double-tap to zoom */
        }

        .tapper-base {
            width: 100%; /* Full width of assembly */
            height: 30px; /* Height of the base */
            background-color: #8B4513; /* SaddleBrown for wood */
            border: 2px solid #5a2d0c; /* Darker brown for border/shadow */
            border-radius: 5px;
    /* box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 2px 3px rgba(255,255,255,0.2); */
            position: absolute;
            bottom: 0;
            z-index: 1;
        }

        .tapper-lever {
            width: 20px; /* Width of the lever arm */
            height: 75px; /* Height of the lever arm, extends above base */
    /* background: linear-gradient(to right, #a98d6a, #8b7355); */ /* Brass gradient */
    background-color: #a98d6a; /* Fallback solid brass color */
            border: 1px solid #6b5335; /* Darker brass outline */
            border-radius: 3px 3px 0 0; /* Rounded top */
    /* box-shadow: 0 -2px 5px rgba(0,0,0,0.2); */
            position: absolute;
            bottom: 25px; /* Sits slightly into the base */
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align key to the top of the lever */
            z-index: 2;
            transition: transform 0.1s ease-out;
        }

        .tapper-key-surface {
            width: 40px; /* Width of the key knob */
            height: 40px; /* Height of the key knob */
            background-color: #a98d6a; /* Brass color */
            border: 2px solid #8b7355; /* Darker brass */
            border-radius: 50%; /* Circular key */
    /* box-shadow: inset 0 -2px 3px rgba(0,0,0,0.3), 0 2px 3px rgba(0,0,0,0.2); */
            margin-top: 5px; /* Positioned at the top of the lever */
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fdfdf5;
            font-family: 'Special Elite', monospace;
            font-size: 10px; /* Small text if any, or remove */
            /* The content "TAP!" can be added via ::before or ::after if desired, or removed */
        }
        .tapper-key-surface::before {
            content: "TAP"; /* Optional: text on the key */
            color: #6b5335; /* Darker text */
        }


        /* Active state for the new tapper */
        /* The JS adds '.active' to 'tapper-assembly' (which is the div with id="tapper") */
        .tapper-assembly.active .tapper-lever {
            transform: translateX(-50%) translateY(3px) rotateX(5deg); /* Move lever down slightly and tilt */
            box-shadow: 0 -1px 3px rgba(0,0,0,0.2);
        }
        .tapper-assembly.active .tapper-key-surface {
            box-shadow: inset 0 -1px 2px rgba(0,0,0,0.4), 0 1px 1px rgba(0,0,0,0.1);
            transform: translateY(1px); /* Slight press down effect on the key itself */
        }


        #spaceButton {
        .tapper {
            width: 120px; /* Mobile first size */
            height: 120px; /* Mobile first size */
            border-radius: 50%;
            background-color: #4a5568; /* Tailwind gray-600 */
            border: 4px solid #2d3748; /* Tailwind gray-700 */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem; /* Smaller for mobile */
            font-weight: bold;
            color: #e2e8f0; /* Tailwind gray-300 */
            cursor: pointer;
            touch-action: manipulation; /* Prevents double-tap to zoom */
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
            /* --- ADD THESE --- */
            -webkit-tap-highlight-color: transparent; /* Removes the gray highlight on tap in mobile Safari */
            -webkit-touch-callout: none; /* Disables the menu that appears on long press */
            transition: all 0.1s ease-out;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            flex-shrink: 0; /* Added from original context if tapper was in flex */
        }
        /* Add media query for larger screens */
        @media (min-width: 768px) { /* md breakpoint */
            .tapper {
                width: 150px;
                height: 150px;
                font-size: 1.5rem; /* Restore original font size for md and up */
            }
        }
        .tapper:active, .tapper.active {
            background-color: #f6e05e; /* Tailwind yellow-300 */
            color: #1a202c; /* Tailwind gray-900 */
            transform: scale(0.95);
            box-shadow: 0 0 20px #f6e05e, 0 0 30px #f6e05e;
        }
        #spaceButton {
            /* Using Tailwind in HTML for most styling */
            /* Example: width: 70px; height: 70px; border-radius: 50%; */
            -webkit-user-select: none; /* For Safari */
            -ms-user-select: none;     /* For IE/Edge */
            user-select: none;         /* Standard */
            touch-action: manipulation; /* Prevents double-tap to zoom, etc. */
            -webkit-tap-highlight-color: transparent; /* Removes the gray highlight on tap in mobile Safari */
            -webkit-touch-callout: none; /* Disables the menu that appears on long press */
        }
        .table-highlight {
            background-color: #f6e05e; /* Tailwind yellow-300 or a similar vibrant color */
            color: #1a202c; /* Tailwind gray-900 or a dark color for contrast */
            font-weight: bold;
        }

        /* Light Theme Styles */
        body.light-theme {
            background-color: #f3f4f6; /* Tailwind gray-100 */
            color: #1f2937; /* Tailwind gray-800 */
        }
        .app-container.light-theme-container {
            background-color: #ffffff; /* white */
            color: #1f2937; /* Tailwind gray-800 */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); /* Lighter shadow */
        }

        /* General light theme adjustments for Tailwind classes */
        .light-theme nav button,
        .light-theme-container nav button {
            background-color: #e5e7eb; /* gray-200 */
            color: #374151; /* gray-700 */
        }
        .light-theme nav button:hover,
        .light-theme-container nav button:hover {
            background-color: #d1d5db; /* gray-300 */
        }
        .light-theme nav button.active-tab-button,
        .light-theme-container nav button.active-tab-button {
            background-color: #3b82f6; /* blue-500 */
            color: #ffffff; /* white */
        }
        .light-theme nav button.active-tab-button:hover,
        .light-theme-container nav button.active-tab-button:hover {
            background-color: #2563eb; /* blue-600 */
        }


        .light-theme .input-output-box,
        .light-theme-container .input-output-box {
            background-color: #e5e7eb; /* Tailwind gray-200 */
            color: #1f2937; /* Tailwind gray-800 */
            border: 1px solid #d1d5db; /* Tailwind gray-300 */
        }

        .light-theme .text-gray-200,
        .light-theme-container .text-gray-200,
        .light-theme .text-gray-300,
        .light-theme-container .text-gray-300,
        .light-theme .text-gray-400, /* For placeholders or secondary text */
        .light-theme-container .text-gray-400 {
             color: #374151 !important; /* Tailwind gray-700, !important to override Tailwind if needed */
        }
        .light-theme .text-white, /* For elements that are explicitly text-white in dark mode */
        .light-theme-container .text-white {
            color: #1f2937 !important; /* Tailwind gray-800 */
        }

        .light-theme .section-title,
        .light-theme-container .section-title {
            color: #2563eb; /* Tailwind blue-600 for light theme */
        }

        /* Backgrounds that are dark gray in dark mode */
        .light-theme .bg-gray-600, .light-theme-container .bg-gray-600,
        .light-theme .bg-gray-700, .light-theme-container .bg-gray-700,
        .light-theme .bg-gray-800, .light-theme-container .bg-gray-800 {
            background-color: #e5e7eb !important; /* gray-200 */
            color: #1f2937 !important; /* Ensure text on these backgrounds is dark */
        }

        .light-theme .border-gray-600, .light-theme-container .border-gray-600 {
            border-color: #d1d5db !important; /* gray-300 */
        }
        /* Note: .placeholder-gray-400 is handled by the general .text-gray-400 override now */
        .light-theme .placeholder-gray-500::placeholder,
        .light-theme-container .placeholder-gray-500::placeholder {
            color: #6b7280; /* gray-500 */
        }

        /* Specific text colors that need adjustment */
        .light-theme .text-yellow-400, .light-theme-container .text-yellow-400 {
            color: #ca8a04; /* Tailwind yellow-600, better contrast on light */
        }
        .light-theme .text-yellow-500, .light-theme-container .text-yellow-500 {
            color: #b45309; /* Tailwind amber-600, better contrast on light */
        }
        .light-theme .text-green-400, .light-theme-container .text-green-400 {
            color: #15803d; /* Tailwind green-700 */
        }
         .light-theme .text-blue-400, .light-theme-container .text-blue-400 {
            color: #2563eb; /* Tailwind blue-600 */
        }
        .light-theme .text-purple-400, .light-theme-container .text-purple-400 {
            color: #7e22ce; /* Tailwind purple-600 */
        }


        /* Book Cipher Specific */
        .light-theme .book-cover-item, .light-theme-container .book-cover-item {
            background-color: #e0e7ff; /* Tailwind indigo-100 */
            border-color: #c7d2fe; /* Tailwind indigo-200 */
            color: #3730a3; /* Tailwind indigo-800 */
        }
        .light-theme .book-cover-item:hover, .light-theme-container .book-cover-item:hover {
            background-color: #c7d2fe; /* Tailwind indigo-200 */
            border-color: #a5b4fc; /* Tailwind indigo-300 */
        }
        .light-theme .book-cover-selected, .light-theme-container .book-cover-selected {
            background-color: #4f46e5; /* Tailwind indigo-600 */
            border-color: #818cf8; /* Tailwind indigo-400 */
            color: #ffffff; /* White text on dark indigo */
        }
        .light-theme #full-book-morse-display, .light-theme-container #full-book-morse-display {
            background-color: #f3f4f6; /* gray-100 */
            border-color: #d1d5db; /* gray-300 */
            color: #1f2937; /* gray-800 */
        }


        /* Morse Pals Specific */
        .light-theme .selected-friend, .light-theme-container .selected-friend {
            background-color: #dbeafe; /* Tailwind blue-100 */
            border-left-color: #3b82f6; /* Tailwind blue-500 */
            color: #1e40af; /* Tailwind blue-800 */
        }
        /* Message Bubbles in Morse Pals & Global Beacon */
        /* Received (gray in dark) */
        .light-theme .bg-gray-600.p-3.rounded-lg, /* More specific selector for message bubbles */
        .light-theme-container .bg-gray-600.p-3.rounded-lg {
            background-color: #e5e7eb !important; /* gray-200 */
            color: #1f2937 !important; /* gray-800 */
        }
         /* Sent (blue in dark) - these are often fine, but ensure good contrast of text if bubble color changes */
        .light-theme .bg-blue-500.text-white.p-3.rounded-lg,
        .light-theme-container .bg-blue-500.text-white.p-3.rounded-lg {
            background-color: #3b82f6 !important; /* blue-500 */
            color: #ffffff !important; /* white */
        }
        /* Global Beacon message items */
        .light-theme .chat-feed .message, .light-theme-container .chat-feed .message {
             background-color: #f3f4f6 !important; /* gray-100 */
             border: 1px solid #e5e7eb; /* gray-200 */
        }


        /* Koch Method Input */
        .light-theme #koch-answer-input, .light-theme-container #koch-answer-input {
            background-color: #ffffff;
            border-color: #d1d5db; /* gray-300 */
            color: #1f2937; /* gray-800 */
        }
        .light-theme #koch-answer-input::placeholder, .light-theme-container #koch-answer-input::placeholder {
            color: #9ca3af; /* gray-400 */
        }


        /* Settings tab specific (if any more needed beyond general) */
        .light-theme #master-sound-toggle + div, .light-theme-container #master-sound-toggle + div { /* The visual part of the toggle */
            background-color: #d1d5db; /* gray-300 for off state */
        }
        .light-theme #master-sound-toggle:checked + div, .light-theme-container #master-sound-toggle:checked + div {
            background-color: #3b82f6; /* blue-500 for on state */
        }


        /* Modal */
        .light-theme #unlocked-text-modal .bg-gray-800,
        .light-theme-container #unlocked-text-modal .bg-gray-800 {
            background-color: #ffffff !important; /* White modal background */
        }
        .light-theme #unlocked-text-modal .bg-gray-700,
        .light-theme-container #unlocked-text-modal .bg-gray-700 { /* Modal content area */
            background-color: #f3f4f6 !important; /* gray-100 for content area */
            color: #1f2937 !important;
        }
        .light-theme #unlocked-text-modal-title,
        .light-theme-container #unlocked-text-modal-title {
            color: #1f2937 !important; /* Dark text for title */
        }


        /* Theme-specific styles for Tailwind-styled elements */
        .light-theme #unit-time-input,
        .light-theme-container #unit-time-input {
            background-color: #e5e7eb; /* gray-200 */
            border-color: #d1d5db; /* gray-300 */
            color: #1f2937; /* gray-800 */
        }
        .light-theme #unit-time-input::placeholder,
        .light-theme-container #unit-time-input::placeholder {
            color: #6b7280; /* gray-500 */
        }

        .light-theme #wpm-slider, .light-theme-container #wpm-slider,
        .light-theme #farnsworth-slider, .light-theme-container #farnsworth-slider,
        .light-theme #freq-slider, .light-theme-container #freq-slider {
            background-color: #d1d5db; /* gray-300 for track */
            /* This only styles the track for some browsers if appearance-none is set.
               Full slider styling is complex and browser-specific.
               Tailwind typically handles this with pseudo-elements like ::-webkit-slider-thumb etc.
               which are harder to override cleanly outside of Tailwind's dark: variant.
               For now, this will change the track color.
            */
        }

        .light-theme #book-selection, .light-theme-container #book-selection,
        .light-theme #target-text-display, .light-theme-container #target-text-display,
        .light-theme #unlocked-text-display, .light-theme-container #unlocked-text-display,
        .light-theme #current-decoded-char, .light-theme-container #current-decoded-char,
        .light-theme #tapperDecodedOutput, .light-theme-container #tapperDecodedOutput,
        .light-theme #tapperMorseOutput, .light-theme-container #tapperMorseOutput {
            background-color: #e5e7eb; /* gray-200 */
            color: #1f2937; /* gray-800 */
        }
        .light-theme #book-selection, .light-theme-container #book-selection,
        .light-theme #target-text-display, .light-theme-container #target-text-display,
        .light-theme #unlocked-text-display, .light-theme-container #unlocked-text-display {
            border-color: #d1d5db; /* gray-300 */
        }
        /* Ensure text-white elements become dark text in light theme */
        .light-theme #book-selection, .light-theme-container #book-selection { /* text-white */
            color: #1f2937; /* gray-800 */
        }

        .light-theme .reference-table th,
        .light-theme-container .reference-table th,
        .light-theme .reference-table td,
        .light-theme-container .reference-table td {
            border: 1px solid #d1d5db; /* gray-300 */
        }
        .light-theme .reference-table th,
        .light-theme-container .reference-table th {
            background-color: #e5e7eb; /* gray-200 */
            /* Text color should be inherited from .app-container.light-theme-container */
        }

        .light-theme .tapper, /* For tapper within .light-theme body */
        .light-theme-container .tapper { /* For tapper within .light-theme-container */
            background-color: #9ca3af; /* Tailwind gray-400 */
            border-color: #6b7280; /* Tailwind gray-500 */
            color: #111827; /* Tailwind gray-900, adjusted for good contrast on gray-400 */
        }
        /* Active state for tapper (.tapper:active or .tapper.active) uses yellow-300 and gray-900,
           which should be fine in light mode as well. No override needed for active state. */

        /* Feedback message styling for themes */
        .light-theme .feedback-message.text-green-500,
        .light-theme-container .feedback-message.text-green-500 {
            color: #16a34a; /* Tailwind green-600 */
        }
        .light-theme .feedback-message.text-red-500,
        .light-theme-container .feedback-message.text-red-500 {
            color: #dc2626; /* Tailwind red-600 */
        }
        .light-theme .feedback-message.text-yellow-500, /* For book cipher messages */
        .light-theme-container .feedback-message.text-yellow-500 {
            color: #d97706; /* Tailwind amber-600 for better contrast on light bg */
        }

    /* Styling for selected friend in Morse Pals list */
    .selected-friend {
        background-color: #4A5568; /* Tailwind gray-600, a bit darker than hover to show selection */
        font-weight: bold; /* Make text bold */
        border-left: 4px solid #4299e1; /* Tailwind blue-500, for a distinct indicator */
    }

    /* Book Library Styles */
    .book-cover-item {
        background-color: #d2b48c; /* Tan / light wood color for the cover */
        padding: 10px;
        border-radius: 3px 5px 5px 3px; /* Simulate book spine curve on one side */
        box-shadow: 5px 5px 10px rgba(0,0,0,0.3), inset 3px 0 5px rgba(0,0,0,0.1); /* Outer shadow and subtle spine shadow */
        border: 1px solid #8b7355; /* Aged brass/darker wood edge */
        color: #3d3d3d; /* Dark sepia text */
        font-size: 0.9rem;
        font-weight: normal; /* Merriweather will provide the classic feel */
        text-align: center;
        cursor: pointer;
        transition: all 0.15s ease-in-out;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-around; /* Better spacing for title and potential author */
        word-break: break-word; /* Ensure text wraps */
        min-height: 9rem; /* Adjusted height */
        position: relative; /* For pseudo-elements like spine gradient */
        background-image: linear-gradient(to right, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.05) 5%, transparent 20%); /* Subtle spine shadow */
    }

    .book-cover-item span { /* Style for the title span inside */
        font-family: 'Special Elite', monospace;
        font-size: 1em; /* Relative to parent's font-size */
        display: block;
        margin-bottom: 5px;
    }
    /* Optional: Add a small author line if design allows */
    .book-cover-item .author {
        font-family: 'Merriweather', serif;
        font-size: 0.7em;
        color: #5a4a3a; /* Darker sepia for author */
    }


    .book-cover-item:hover {
        background-color: #c8a97e; /* Slightly darker tan on hover */
        border-color: #6b5335; /* Darker brass hover border */
        box-shadow: 7px 7px 12px rgba(0,0,0,0.35), inset 3px 0 5px rgba(0,0,0,0.15);
        transform: translateY(-2px);
    }

    .book-cover-selected {
        background-color: #b99d7a; /* Brass accent for selected */
        border-color: #8b7355; /* Darker aged brass */
        color: #fdfdf5; /* Cream text on brass */
        box-shadow: 0 0 10px #a98d6a, inset 0 0 5px rgba(0,0,0,0.2); /* Glow and inset */
        transform: scale(1.03);
    }
    .book-cover-selected span { /* Title on selected book */
        color: #fdfdf5;
    }
    .book-cover-selected .author { /* Author on selected book */
        color: #f0eade; /* Lighter sepia for author */
    }

    /* Progress Indication for Book Cipher */
    #current-decoded-char { /* Target Morse Letter Display */
        background-color: #a98d6a; /* Brass accent */
        color: #fdfdf5; /* Cream text */
        border: 2px solid #8b7355; /* Aged brass border */
        padding: 5px 10px;
        border-radius: 3px;
        font-family: 'Courier Prime', monospace; /* Already set globally, but ensures it */
        font-size: 1.5rem; /* Larger for prominence */
        min-width: 80px; /* Ensure it has some width */
        text-align: center;
        box-shadow: inset 0 0 3px rgba(0,0,0,0.2), 0 1px 2px rgba(0,0,0,0.1);
    }

    .deciphered-char { /* For text already deciphered in the full Morse display */
       color: #5d4037; /* Darker, rich brown, like ink on old paper */
       font-weight: bold;
       /* background-color: rgba(240, 234, 222, 0.5); /* Slight parchment highlight */
       /* padding: 0 2px; */
       /* border-radius: 2px; */
    }

    /* Styling for locked pro books */
    .book-cover-item.opacity-50 { /* Tailwind class used for locked books */
        background-color: #e0e0e0; /* Lighter gray for locked */
        background-image: none; /* Remove spine gradient */
        box-shadow: 3px 3px 7px rgba(0,0,0,0.2);
        border-color: #b0b0b0;
        color: #757575;
    }
    .book-cover-item.opacity-50 span {
        color: #757575;
    }
     .book-cover-item.opacity-50:hover {
        background-color: #d0d0d0;
        border-color: #a0a0a0;
        transform: none; /* No hover transform for locked items */
     }

    /* Settings Page Toggles */

    /* General styling for toggle switch containers if needed */
    .setting-item .switch,
    #master-sound-toggle + div { /* Direct selector for the visual part of master sound toggle */
        /* Reset some defaults if they interfere */
    }

    /* Vintage Toggle Switch for Theme Toggle */
    .switch {
        position: relative;
        display: inline-block;
        width: 70px;  /* Wider for a more substantial switch */
        height: 30px; /* Bakelite-style height */
        background-color: #504030; /* Dark brown Bakelite color */
        border-radius: 3px; /* Sharp edges for Bakelite */
        border: 1px solid #302010; /* Darker border */
        box-shadow: 0 2px 3px rgba(0,0,0,0.4), inset 0 1px 2px rgba(255,255,255,0.1);
        cursor: pointer;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider { /* This is the moving part (lever) of the theme toggle */
      position: absolute;
      cursor: pointer;
      top: 2px;    /* Position within the switch body */
      left: 3px;
      height: 24px; /* Lever height */
      width: 30px;  /* Lever width */
      background-color: #a98d6a; /* Brass color for the lever */
      border: 1px solid #8b7355; /* Darker brass edge */
      border-radius: 2px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.3);
      transition: .3s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Bouncy transition */
    }

    /* Remove ::before for the old circular knob if it was part of .slider */
    .slider:before {
      content: none;
    }

    input:checked + .slider {
      transform: translateX(34px); /* Move lever to the other side */
      background-color: #b99d7a; /* Slightly lighter brass when 'on' */
    }

    /* Removing focus style, or can adapt to new theme */
    input:focus + .slider {
      box-shadow: 0 0 2px #8b7355;
    }

    /* Remove .slider.round styles as we are not using a round slider */
    .slider.round { border-radius: 2px; }
    .slider.round:before { content: none; }


    /* Vintage Toggle for Master Sound */
    /* The master sound toggle is a div sibling to a 'peer' input */
    #master-sound-toggle + div {
        width: 70px !important; /* Override Tailwind w-11 */
        height: 30px !important; /* Override Tailwind h-6 */
        background-color: #504030 !important; /* Dark brown Bakelite */
        border-radius: 3px !important; /* Sharp edges */
        border: 1px solid #302010 !important;
        box-shadow: 0 2px 3px rgba(0,0,0,0.4), inset 0 1px 2px rgba(255,255,255,0.1) !important;
        position: relative; /* For the lever */
        transition: background-color 0.3s ease !important;
    }

    #master-sound-toggle + div::after { /* This is the lever */
        content: '' !important;
        position: absolute !important;
        top: 2px !important;
        left: 3px !important;
        width: 30px !important; /* Lever width */
        height: 24px !important; /* Lever height */
        background-color: #a98d6a !important; /* Brass color */
        border: 1px solid #8b7355 !important;
        border-radius: 2px !important;
        box-shadow: 0 1px 2px rgba(0,0,0,0.3) !important;
        transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    }

    #master-sound-toggle:checked + div { /* 'On' state for Bakelite body */
        background-color: #605040 !important; /* Slightly lighter/different Bakelite when on */
    }

    #master-sound-toggle:checked + div::after { /* 'On' state for lever */
        transform: translateX(34px) !important; /* Move lever */
        background-color: #b99d7a !important; /* Lighter brass for lever when 'on' */
    }

    /* Remove Tailwind focus rings if they don't fit */
    #master-sound-toggle.peer:focus + div {
        outline: none !important;
        /* box-shadow: 0 0 0 2px #8b7355 !important; /* Custom focus ring */
        box-shadow: 0 2px 3px rgba(0,0,0,0.4), inset 0 1px 2px rgba(255,255,255,0.1), 0 0 0 2px #8b7355 !important; /* Keep original shadow + focus ring */

    }


    /* For Book Cipher Highlighting */
    .current-morse-target {
        background-color: #f6e05e; /* Tailwind yellow-300 */
        color: #1a202c;           /* Tailwind gray-900 */
        font-weight: bold;
        padding: 0.1em 0.25em;     /* Use em for padding relative to font size */
        border-radius: 3px;
        box-shadow: 0 0 5px #f6e05e; /* Optional: add a subtle glow */
        transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out; /* Smooth transition */
    }

    .morse-char-span {
        /* Add a little padding to each span so highlight doesn't look too cramped */
        padding: 0.05em;
    }

    /* Ensure the full morse display has good contrast and readability */
    #full-book-morse-display {
        font-family: 'Courier New', Courier, monospace; /* Monospaced font for Morse */
        font-size: 1.1rem; /* Slightly larger font for readability */
        line-height: 1.6;  /* Adjust line spacing */
        /* max-height: 400px; /* Already set in HTML, confirm it's good */
        /* overflow-y: auto; /* Already set in HTML */
        /* background-color: #1f2937; /* Slightly different shade if needed, current is gray-700 */
    }

   .deciphered-char {
       color: #a0aec0; /* A light gray color (Tailwind gray-500) */
       font-weight: bold; /* Make it bold to stand out */
   }

    /* Input feedback animations */
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
    }

    @keyframes glow-green {
        0% { box-shadow: 0 0 3px rgba(74, 222, 128, 0.7); } /* Tailwind green-400 */
        50% { box-shadow: 0 0 15px 5px rgba(74, 222, 128, 1); }
        100% { box-shadow: 0 0 3px rgba(74, 222, 128, 0.7); }
    }

    .shake-red {
        animation: shake 0.5s ease-in-out;
        background-color: #fca5a5; /* Tailwind red-300 */
        border-color: #ef4444 !important; /* Tailwind red-500, !important to override focus styles if needed */
        color: #7f1d1d; /* Tailwind red-900 for text */
    }

    .glow-green {
        animation: glow-green 0.8s ease-out;
        background-color: #86efac; /* Tailwind green-300 */
        border-color: #22c55e !important; /* Tailwind green-500, !important to override focus styles */
        color: #14532d; /* Tailwind green-900 for text */
    }

        #predictive-taps-display {
            height: auto; /* Allow height to adjust for wrapped content */
            min-height: 3em; /* Keep the min-height to prevent layout shift */
            display: flex;
            flex-wrap: wrap; /* This is the key property to allow wrapping */
            justify-content: center;
            gap: 0.25rem; /* Adds a small space between badges */
            align-items: center;
            /* Assuming other styles like padding, border are handled by Tailwind classes in HTML */
            /* If not, add them here:
            /* padding: 0.5rem; */
            /* border: 1px solid #4A5568; /* Example border */
            /* border-radius: 0.375rem; /* Example border-radius */
        }

        /* Upsell Modal Styles */
        /* The modal itself uses Tailwind classes for positioning and basic layout.
           Specific styling for elements within the modal can be added here if needed,
           but the current HTML uses Tailwind extensively. */

        /* Example: Style for the list items if Tailwind wasn't sufficient */
        /* #upsell-modal ul li {
            color: #333;
        } */

        .char-badge {
            /* Tailwind classes: bg-gray-600 text-gray-200 text-xs font-mono rounded-md px-2 py-1 */
            background-color: #4A5568; /* bg-gray-600 */
            color: #E2E8F0; /* text-gray-200 */
            font-size: 0.75rem; /* text-xs */
            font-family: 'SFMono-Regular', Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; /* font-mono */
            border-radius: 0.375rem; /* rounded-md */
            padding-left: 0.5rem; /* px-2 */
            padding-right: 0.5rem; /* px-2 */
            padding-top: 0.25rem; /* py-1 */
            padding-bottom: 0.25rem; /* py-1 */
            /* Adding display inline-flex for better alignment if needed, though flex items in a flex container behave well */
            display: inline-flex;
            align-items: center;
            margin: 0.125rem; /* Add a small margin for separation if gap isn't enough or for items that might break lines weirdly */
        }

        .char-badge.exact-match-highlight {
            background-color: #FBBF24; /* Corresponds to Tailwind's yellow-400 */
            color: #000000;       /* Corresponds to Tailwind's black */
        }

@media (min-width: 768px) { /* This is Tailwind's 'md' breakpoint */
  #morse-reference-container.hidden {
    display: block !important; /* Force the table to be visible on desktop */
  }

  #toggle-reference-btn {
    display: none !important; /* Ensure the toggle button is hidden on desktop */
  }
}

.ad-placeholder-container {
  width: 100%;
  min-height: 60px;
  background-color: #3a3a3a;
  border: 1px dashed #555;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.8rem;
  color: #888;
}
.ad-placeholder-container::before {
  content: 'Ad Placeholder';
}

#ad-banner-container {
  position: fixed;
  bottom: 0;
  width: 100%;
  z-index: 1000; /* Ensure it's on top of other content */
  /* Optional: Add background color for testing visibility */
  /* background-color: rgba(255, 0, 0, 0.1); */
  /* Optional: Add a minimum height if needed, AdMob SDK might handle this */
  /* min-height: 50px; */
}
